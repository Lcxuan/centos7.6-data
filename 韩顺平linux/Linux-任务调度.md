## 任务调度

### 概述

任务调度：指系统在某个时间执行的特定的命令或程序

任务调度分类：系统工作：有些重要的工作必须周而复始地执行。如病毒扫描等

个别用户工作：个别用户可能希望执行某些程序，比如对mysql数据库的备份

### crontab

语法：crontab 【选项】

选项：

-e：编辑crontab定时任务

-l：查询crontab任务

-r：删除当前用户所有的crontab任务，终止任务调度

描述：进行定时任务的设置



设置任务调度文件：/etc/crontab

设置个人任务调度：执行crontab -e命令，接着输入任务掉调度文件



如：*/1****ls -l /etc/ > /tmp/to.txt

意思：每个小时的每分钟执行ls -l /etc/ > /tmp/to.txt命令

### 参数说明

5分占位符

第一个"*"：一小时当中的第几分钟（0~59）

第二个"*"：一天当中的第几小时（0~23）

第三个"*"：一个月当中的第几天（1-31）

第四个"*"：一年当中的第几月（1~12）

第五个"*"：一周当中的星期几（0~7，0和7都代表星期日）

### 特殊符号

```
*：代表任何时间：比如第一个*就代表一小时中每分钟都执行一次的意思

,：代表不连续时间，比如"0 8,12,16***命令"，就代表在每天的8点0分，12点0分，16点0分都执行一次

-：代表连续的时间范围，比如"0 5 * * 1-6命令",代表在周一到周六的凌晨5点执行命令

*/n：代表每隔多久执行一次，比如"*/10 * * * * 命令"，代表每隔10分钟就执行一遍命令
```



### at定时任务

at命令是一次性定时计划任务，at的守护进程atd会以后台模式运行，检查作业队列来运行

默认情况下，atd守护进程每60秒检查作业队列，有作业时，会检查作业运行时间，如果时间与当前时间匹配，则运作此作业

at命令是一次性定时计划任务，执行完一个任务后不再执行次任务了

在使用at命令时，一定保证atd进程的启动，可以使用ps -ef来查看

#### 使用方式

语法：at 【选项】【时间】

参数：

-m：当指定的任务被完成后，将给用户发送邮件，即时没有标准输出

-I：atq的别名

-d：atrm的别名

-v：显示任务将被执行的时间

-c：打印任务的内容到标准输出

-V：显示版本信息

-q<队列>：使用指定的队列

-f<文件>：从指定文件读入任务而不是从标准输入读入

-t<时间参数>：以时间参数的形式提交要运行的任务

描述：ctrl+d结束at命令的输入

#### at指定时间的方法

1、接受在当天的hh:mm（小时:分钟）式的时间指定，加入该时间已过去，那么放在第二天执行，例如：04:00

2、使用midnight（深夜）、noon（中午）、teatime（饮茶时间，一般是下午4点）等比较模糊的词语来指定时间

3、采用12小时计时制，即在时间后面加上AM（上午）或PM（下午）来说明是上午还是下午，例如：12pm

4、指定命令执行的具体日期，指定格式为month day（月 日）或mm/ddyy（月/日/年）或dd.mm.yy（日.月.年），指定的日期必须跟在指定时间的后面。例如：04:00 2021-03-1

5、使用相对计时法，指定格式为：now + count time-units，now就是当前时间，count是时间的数量，time-units是时间单位，能够是minutes（分钟）、hours（小时）、days（天）、weeks（星期），例如：now+5 minutes

6、直接使用today（今天）、tomorrow（明天）来指定完成命令的时间

### atq

查看当前没有被执行的任务

### atrm

语法：atrm 任务编号

描述：删除指定编号的执行任务